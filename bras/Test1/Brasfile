

##### Need some files to start from
foreach x {cSuffixNewer.y cSuffixExist.s firstFile} {
  if {![file exist $x]} {
    exec touch $x
  }
}


##### simple suffix rules
SuffixExist .x .y {
  cp $newer $target
}

SuffixNewer .r .s {
  ls -l $newer >$target
}


##### general rules to test a bit
Always all {cNewer cExist cSuffixNewer.x cSuffixExist.r cNewerBad \
	      @../Test2} {
  foreach x $deps {
    if {![file exist $x]} {
      error "file [pwd]/$x not build"
    }
  }
}

## 
## This rule should only fire on the first run
##
Newer cNewer firstFile {
  touch cNewer
}
##
## This rule should always fire, because the dependency is touched in
## the command.
##
Newer cNewerBad otherfile {
  touch $target
  sleep 1
  touch $deps
}
Exist otherfile {} {
  touch otherfile
}

##
## Although the dependency is touched after the target, the rule
## should only fire on the first run.
##
Exist cExist somefile {
  if {![file exist $deps]} {
    error "[pwd]/somefile not build "
  }
  touch cExist
  touch somefile
}
Exist somefile {} {
  touch somefile
}



##### cleaning up

Always clean {} {
  rm -f cNewer cExist cSuffixNewer.x cSuffixExist.x
  rm -f cSuffixNewer.y cSuffixExist.r cSuffixExist.s somefile firstFile
  rm -f cNewerBad otherfile
}


