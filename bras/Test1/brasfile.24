puts "msg: Sourcing dependency file generated by C compiler"

puts "expect: rm -f .depend"
puts "expect: Newer A.c A.h b.h c.h d.h e.h x.h y.h z.h"
puts "expect: Newer B.c B.h"


## A dummy rule 
Exist X { }

## We generate the dependency file ourselves, because you really never
## know, how to call a C compiler
set out [open .depend w]
puts $out "\
A.o: A.c A.h b.h \\
     c.h d.h e.h
A.o: x.h y.h z.h

B.o: B.c B.h
B.o: /usr/local/stdio.h
"
close $out

# Now source it
sourceDeps .depend /usr/local
exec rm -f .depend

set rid $brasTinfo(A.o,[pwd],rule)
puts "$brasRule($rid,type) $brasRule($rid,deps)"

set rid $brasTinfo(B.o,[pwd],rule)
puts "$brasRule($rid,type) $brasRule($rid,deps)"

